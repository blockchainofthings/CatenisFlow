<script type="text/javascript">
    RED.nodes.registerType('issue asset', {
        category: 'Catenis Flow',
        color: '#9f9fe4',
        defaults: {
            name: { value: "" },
            connection: { value: "", type: "catenis api connection", required: true },
            assetName: { value: "" },
            assetDescription: { value: "" },
            canReissue: { value: false },
            decimalPlaces: { value: "" },
            holdingDeviceId: { value: "" },
            isProdUniqueId: { value: false }
        },
        inputs:1,
        outputs:1,
        icon: "issue_asset.png",
        label: function () {
            return this.name || "Issue asset";
        }
    });
</script>

<script type="text/x-red" data-template-name="issue asset">
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
    <div class="form-row">
        <label for="node-input-connection"><i class="fa fa-exchange"></i> Connection</label>
        <input type="text" id="node-input-connection">
    </div>
    <div class="form-row">
        <hr>
    </div>
    <div class="form-row">
        <label for="node-input-assetName"><i class="fa fa-tag"></i> Asset name</label>
        <input type="text" id="node-input-assetName">
    </div>
    <div class="form-row">
        <label for="node-input-assetDescription"><i class="fa fa-file-alt"></i> Asset description</label>
        <input type="text" id="node-input-assetDescription">
    </div>
    <div class="form-row">
        <label for="node-input-canReissue"><i class="fa fa-clone"></i> Can reissue</label>
        <input type="checkbox" id="node-input-canReissue">
    </div>
    <div class="form-row">
        <label for="node-input-decimalPlaces"><i class="fa fa-calculator"></i> Decimal places</label>
        <input type="number" id="node-input-decimalPlaces" step="1" min="0" max="7">
    </div>
    <div class="form-row">
        <label for="node-input-holdingDeviceId"><i class="fa fa-microchip"></i> Holding device ID</label>
        <input type="text" id="node-input-holdingDeviceId">
    </div>
    <div class="form-row">
        <label for="node-input-isProdUniqueId"><i class="fa fa-tag"></i> Product unique ID</label>
        <input type="checkbox" id="node-input-isProdUniqueId">
    </div>
</script>

<script type="text/x-red" data-help-name="issue asset">
    <p>Call Catenis API "Issue Asset" method to issue an amount of a new asset.</p>
    <h3>Inputs</h3>
    <dl class="message-properties">
        <dt>payload<span class="property-type">number</span></dt>
        <dd>The amount of asset to issue</dd>
    </dl>
    <dl class="message-properties">
        <dt>payload<span class="property-type">object</span></dt>
        <dt style="margin-left:1em" class="optional">assetInfo<span class="property-type">object</span></dt>
        <dt style="margin-left:2em">name<span class="property-type">string</span></dt>
        <dd style="margin-left:2.5em">The name of the asset to create</dd>
        <dt style="margin-left:2em" class="optional">description<span class="property-type">string</span></dt>
        <dd style="margin-left:2.5em">A description of the asset to create. <b>Note:</b> should be set to <i>null</i> to force asset not to have a description</dd>
        <dt style="margin-left:2em">canReissue<span class="property-type">boolean</span></dt>
        <dd style="margin-left:2.5em">Indicates whether more units of this asset can be issued at another time</dd>
        <dt style="margin-left:2em">decimalPlaces<span class="property-type">number</span></dt>
        <dd style="margin-left:2.5em">The maximum number of decimal places that can be used to specify a fractional amount of this asset</dd>
        <dt style="margin-left:1em">amount<span class="property-type">number</span></dt>
        <dd style="margin-left:1.5em">The amount of asset to issue</dd>
        <dt style="margin-left:1em" class="optional">holdingDevice<span class="property-type">object</span></dt>
        <dd style="margin-left:1.5em"><b>Note:</b> should be set to <i>null</i> to indicate that holding device should not be specified</dd>
        <dt style="margin-left:2em">id<span class="property-type">string</span></dt>
        <dd style="margin-left:2.5em">ID of holding device. Should be a virtual device ID unless isProdUniqueId is true</dd>
        <dt style="margin-left:2em" class="optional">isProdUniqueId<span class="property-type">boolean</span></dt>
        <dd style="margin-left:2.5em">Indicates whether supplied ID is a product unique ID</dd>
    </dl>
    <h3>Outputs</h3>
    <dl class="message-properties">
        <dt>payload<span class="property-type">object</span></dt>
        <dt style="margin-left:1em">assetId<span class="property-type">string</span></dt>
        <dd style="margin-left:1.5em">ID of the newly issued asset</dd>
    </dl>
    <h3>Details</h3>
    <p>The configuration settings (except for Name and Connection) are used to set the default for the parameters of the corresponding Catenis API method.</p>
    <p>The payload of the received message can be either a number or an object. If it is a number, it specifies the amount of the asset to issue and the default settings (as specified in the node’s configuration) are used for the other parameters.</p>
    <p>In case an object is received, the amount and other parameters are gotten from it. Any parameter present in the message payload supersedes the default settings (as specified in the node’s configuration).</p>
    <p>The data returned from a successful call to the Catenis API method are passed through the node’s single output.</p>
    <h3>References</h3>
    <ul>
        <li><a target="catenis_docs" href="https://catenis.com/docs/api">Catenis API Docs</a> - complete information about Catenis API</li>
    </ul>
</script>
