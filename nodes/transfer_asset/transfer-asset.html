<script type="text/javascript">
    RED.nodes.registerType('transfer asset', {
        category: 'Catenis Flow',
        color: '#9f9fe4',
        defaults: {
            name: { value: "" },
            connection: { value: "", type: "catenis api connection", required: true },
            assetId: { value: "" },
            receivingDeviceId: { value: "" },
            isProdUniqueId: { value: false }
        },
        inputs:1,
        outputs:1,
        icon: "transfer_asset.svg",
        label: function () {
            return this.name || "Transfer asset";
        }
    });
</script>

<script type="text/html" data-template-name="transfer asset">
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
    <div class="form-row">
        <label for="node-input-connection"><i class="fa fa-exchange"></i> Connection</label>
        <input type="text" id="node-input-connection">
    </div>
    <div class="form-row">
        <hr>
    </div>
    <div class="form-row">
        <label for="node-input-assetId"><i class="fa fa-tag"></i> Asset ID</label>
        <input type="text" id="node-input-assetId">
    </div>
    <div class="form-row">
        <label for="node-input-receivingDeviceId"><i class="fa fa-microchip"></i> Receiving device ID</label>
        <input type="text" id="node-input-receivingDeviceId">
    </div>
    <div class="form-row">
        <label for="node-input-isProdUniqueId"><i class="fa fa-tag"></i> Product unique ID</label>
        <input type="checkbox" id="node-input-isProdUniqueId">
    </div>
</script>

<script type="text/html" data-help-name="transfer asset">
    <p>Call Catenis API "Transfer Asset" method to transfer an amount of an asset to a device.</p>
    <h3>Inputs</h3>
    <dl class="message-properties">
        <dt>payload<span class="property-type">number</span></dt>
        <dd>The amount of asset to transfer</dd>
    </dl>
    <dl class="message-properties">
        <dt>payload<span class="property-type">object</span></dt>
        <dt style="margin-left:1em">assetId<span class="property-type">string</span></dt>
        <dd style="margin-left:1.5em">ID of the asset to transfer an amount of it</dd>
        <dt style="margin-left:1em">amount<span class="property-type">number</span></dt>
        <dd style="margin-left:1.5em">The amount of asset to transfer</dd>
        <dt style="margin-left:1em" class="optional">receivingDevice<span class="property-type">object</span></dt>
        <dt style="margin-left:2em">id<span class="property-type">string</span></dt>
        <dd style="margin-left:2.5em">ID of receiving device. Should be a virtual device ID unless isProdUniqueId is true</dd>
        <dt style="margin-left:2em" class="optional">isProdUniqueId<span class="property-type">boolean</span></dt>
        <dd style="margin-left:2.5em">Indicates whether supplied ID is a product unique ID</dd>
    </dl>
    <h3>Outputs</h3>
    <dl class="message-properties">
        <dt>payload<span class="property-type">object</span></dt>
        <dt style="margin-left:1em">remainingBalance<span class="property-type">number</span></dt>
        <dd style="margin-left:1.5em">Total balance of the asset still held by the device after the transfer</dd>
    </dl>
    <h3>Details</h3>
    <p>The configuration settings (except for Name and Connection) are used to set the default for the parameters of the corresponding Catenis API method.</p>
    <p>The payload of the received message can be either a number or an object. If it is a number, it specifies the amount of the asset to transfer and the default settings (as specified in the node’s configuration) are used for the other parameters.</p>
    <p>In case an object is received, the amount and other parameters are gotten from it. Any parameter present in the message payload supersedes the default settings (as specified in the node’s configuration).</p>
    <p>The data returned from a successful call to the Catenis API method are passed through the node’s single output.</p>
    <h3>References</h3>
    <ul>
        <li><a target="catenis_docs" href="https://catenis.com/docs/api">Catenis API Docs</a> - complete information about Catenis API</li>
    </ul>
</script>
